parameters:
    pieces_jointes_directory: '%kernel.project_dir%/public/uploads/pieces_jointes'
    produits_images_dir: '%kernel.project_dir%/public/uploads/produits'
    openfda.api_key: '%env(OPENFDA_API_KEY)%'
    openfda.timeout: '%env(int:OPENFDA_TIMEOUT)%'

services:
    _defaults:
        autowire: true
        autoconfigure: true
        bind:
            # ✅ Binding global pour éviter les erreurs d'injection
            $projectDir: '%kernel.project_dir%'
            $appSecret: '%env(APP_SECRET)%'

    # Stripe
    App\Service\StripePaymentService:
        arguments:
            $stripeSecretKey: '%env(STRIPE_SECRET_KEY)%'
            $appUrl: '%env(APP_URL)%'

    # Twilio
    App\Service\TwilioSmsService:
        arguments:
            $sid: '%env(TWILIO_SID)%'
            $token: '%env(TWILIO_TOKEN)%'
            $from: '%env(TWILIO_FROM)%'

    # OpenFDA
    App\Service\OpenFdaService:
        arguments:
            $apiKey: '%openfda.api_key%'

    # ✅ QR Code Service (plus besoin de arguments car bind global)
    App\Service\QrCodeService: ~

    # Auto-register services in src/
    App\:
        resource: '../src/'
        exclude:
            - '../src/DependencyInjection/'
            - '../src/Entity/'
            - '../src/Kernel.php'